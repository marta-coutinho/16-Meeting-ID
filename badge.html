<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Badge do Evento</title>
  <style>
    body {
      background: #f0f2f5;
      font-family: 'Inter', sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .badge {
      width: 300px;
      height: 440px;
      background: #e5f878;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .photo img { width: 100%; height: 100%; object-fit: cover; }
    .info { padding: 18px 20px; text-align: left; }
    .name { font-size: 1.6rem; font-weight: 600; }
    .company { font-size: 0.95rem; color: #444; }
  </style>
</head>
<body>

  <div class="badge" id="badge" style="display:none;">
    <div class="photo"><img id="foto" src="" alt="Foto"></div>
    <div class="info">
      <div class="welcome">Bem-vindo</div>
      <div class="name" id="nome"></div>
      <div class="company" id="empresa"></div>
    </div>
  </div>

  <script>
    async function carregarBadge() {
      const params = new URLSearchParams(window.location.search);
      const emailOuId = params.get("id")?.toLowerCase() || params.get("email")?.toLowerCase();

      if (!emailOuId) {
        document.body.innerHTML = "<h3>QR Code inválido ou sem identificação.</h3>";
        return;
      }

      try {
        const resposta = await fetch("dados.json");
        const dados = await resposta.json();

        // procura por ID ou e-mail
        const pessoa = dados.find(p =>
          (p.id && p.id.toString() === emailOuId) ||
          (p.email && p.email.toLowerCase() === emailOuId)
        );

        if (!pessoa) {
          document.body.innerHTML = "<h3>Participante não encontrado.</h3>";
          return;
        }

        document.getElementById("badge").style.display = "flex";
        document.getElementById("foto").src = pessoa.foto || "https://i.imgur.com/DaxlryZ.jpeg";
        document.getElementById("nome").textContent = pessoa.nome;
        document.getElementById("empresa").textContent = pessoa.empresa;
      } catch (err) {
        console.error(err);
        document.body.innerHTML = "<h3>Erro ao carregar dados. Verifica a ligação ao servidor.</h3>";
      }
    }

    carregarBadge();
  </script>
</body>
</html>
